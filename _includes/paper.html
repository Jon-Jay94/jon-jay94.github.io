{% comment %}
Reusable paper block
Usage:
{% include paper.html
  title="Trading Volume and Monetary Policy Surprises"
  coauthors=""
  venue=""
  status="Job Market Paper"
  badges=""
  draft_url="/files/jmp_draft.pdf"
  ssrn_url="https://ssrn.com/..."
  bibtex='@techreport{jensen2025,...}'
  abstract="One-line teaser for homepage."
  presentations="AFA 2026*;"
  note="(* scheduled)"
  figure="/assets/img/jmp_figure.png"
%}
{% endcomment %}

<div class="paper" id="paper-{{ include.title | slugify }}">
<h3 class="paper__title">
  {% if include.draft_url %}
    <a href="{{ include.draft_url }}" class="paper__title-link" target="_blank" rel="noopener noreferrer">
      {{ include.title }}
    </a>
  {% else %}
    {{ include.title }}
  {% endif %}
  <span class="paper__toggle" role="button" tabindex="0"
        aria-expanded="{{ include.expanded | default: false }}"
        data-target="paper-body-{{ include.title | slugify }}">
    ▾
  </span>
  {% if include.status %}<span class="badge">{{ include.status }}</span>{% endif %}
</h3>

  {% if include.coauthors or include.venue %}
  <p class="paper__meta">
    {% if include.coauthors %}<em>{{ include.coauthors }}</em>{% endif %}
    {% if include.venue %} · {{ include.venue }}{% endif %}
  </p>
  {% endif %}

  {% if include.badges %}
  <p class="paper__awards">{{ include.badges }}</p>
  {% endif %}

  <details id="paper-body-{{ include.title | slugify }}" class="paper__details" {% if include.expanded %}open{% endif %}>
    <summary class="screen-reader-text">Details</summary>


    {% if include.abstract %}
      <h4 class="paper__label">Abstract</h4>
      <div class="paper__abstract">{{ include.abstract | markdownify }}</div>
    {% endif %}

    <p class="paper__cta">
      {% if include.draft_url %}<a class="btn" href="{{ include.draft_url }}">Draft</a>{% endif %}
      {% if include.ssrn_url %}<a class="btn" href="{{ include.ssrn_url }}">SSRN</a>{% endif %}
      {% if include.slide_url %}<a class="btn" href="{{ include.slide_url }}">Slides</a>{% endif %}
      {% if include.code_url %}<a class="btn" href="{{ include.code_url }}">Code/Data</a>{% endif %}
      {% if include.bibtex %}
      <a class="btn" href="#" onclick="event.preventDefault(); this.nextElementSibling.style.display = (this.nextElementSibling.style.display === 'block' ? 'none' : 'block');">BibTeX</a>
      <pre style="display:none;"><code>{{ include.bibtex | escape }}</code></pre>
      {% endif %}
    </p>


    {% if include.presentations %}
      <div class="paper__presentations">
        <span class="paper__label">Selected presentations</span>
        <p class="paper__presentations-text">{{ include.presentations }} {% if include.note %}{{ include.note }}{% endif %}</p>
      </div>
    {% endif %}

    {% if include.figure %}
    <figure class="paper__figure">
      <img src="{{ include.figure }}" alt="Figure for {{ include.title }}">
    </figure>
    {% endif %}
  </details>
</div>

<hr class="section-rule">
<script>
  document.addEventListener("click", function(e) {
    const toggle = e.target.closest(".paper__toggle");
    if (!toggle) return;
    const details = document.getElementById(toggle.dataset.target);
    const isOpen = details.hasAttribute("open");
    if (isOpen) {
      details.removeAttribute("open");
      toggle.setAttribute("aria-expanded", "false");
      toggle.textContent = "▾";
    } else {
      details.setAttribute("open", "");
      toggle.setAttribute("aria-expanded", "true");
      toggle.textContent = "▴";
    }
  });
</script>